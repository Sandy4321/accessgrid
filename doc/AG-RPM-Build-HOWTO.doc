{\rtf1\ansi\ansicpg1252\uc1\deff0\stshfdbch0\stshfloch0\stshfhich0\stshfbi0\deflang1033\deflangfe1033{\fonttbl{\f0\froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}{\f1\fswiss\fcharset0\fprq2{\*\panose 020b0604020202020204}Arial;}
{\f2\fmodern\fcharset0\fprq1{\*\panose 02070309020205020404}Courier New;}{\f3\froman\fcharset2\fprq2{\*\panose 05050102010706020507}Symbol;}{\f5\fmodern\fcharset0\fprq1{\*\panose 02070409020205020404}Courier{\*\falt Courier New};}
{\f106\froman\fcharset238\fprq2 Times New Roman CE;}{\f107\froman\fcharset204\fprq2 Times New Roman Cyr;}{\f109\froman\fcharset161\fprq2 Times New Roman Greek;}{\f110\froman\fcharset162\fprq2 Times New Roman Tur;}
{\f111\froman\fcharset177\fprq2 Times New Roman (Hebrew);}{\f112\froman\fcharset178\fprq2 Times New Roman (Arabic);}{\f113\froman\fcharset186\fprq2 Times New Roman Baltic;}{\f114\froman\fcharset163\fprq2 Times New Roman (Vietnamese);}
{\f116\fswiss\fcharset238\fprq2 Arial CE;}{\f117\fswiss\fcharset204\fprq2 Arial Cyr;}{\f119\fswiss\fcharset161\fprq2 Arial Greek;}{\f120\fswiss\fcharset162\fprq2 Arial Tur;}{\f121\fswiss\fcharset177\fprq2 Arial (Hebrew);}
{\f122\fswiss\fcharset178\fprq2 Arial (Arabic);}{\f123\fswiss\fcharset186\fprq2 Arial Baltic;}{\f124\fswiss\fcharset163\fprq2 Arial (Vietnamese);}{\f126\fmodern\fcharset238\fprq1 Courier New CE;}{\f127\fmodern\fcharset204\fprq1 Courier New Cyr;}
{\f129\fmodern\fcharset161\fprq1 Courier New Greek;}{\f130\fmodern\fcharset162\fprq1 Courier New Tur;}{\f131\fmodern\fcharset177\fprq1 Courier New (Hebrew);}{\f132\fmodern\fcharset178\fprq1 Courier New (Arabic);}
{\f133\fmodern\fcharset186\fprq1 Courier New Baltic;}{\f134\fmodern\fcharset163\fprq1 Courier New (Vietnamese);}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;
\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}{\stylesheet{
\ql \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext0 Normal;}{\s1\ql \li0\ri0\sb440\sa60\nowidctlpar\faauto\outlinelevel0\rin0\lin0\itap0 
\b\f1\fs34\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext0 heading 1;}{\s2\ql \li0\ri0\sb440\sa60\nowidctlpar\faauto\outlinelevel1\rin0\lin0\itap0 \b\f1\fs28\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext0 
heading 2;}{\s3\ql \li0\ri0\sb440\sa60\nowidctlpar\faauto\outlinelevel2\rin0\lin0\itap0 \b\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext0 heading 3;}{\*\cs10 \additive \ssemihidden Default Paragraph Font;}{\*
\ts11\tsrowd\trftsWidthB3\trpaddl108\trpaddr108\trpaddfl3\trpaddft3\trpaddfb3\trpaddfr3\trcbpat1\trcfpat1\tscellwidthfts0\tsvertalt\tsbrdrt\tsbrdrl\tsbrdrb\tsbrdrr\tsbrdrdgl\tsbrdrdgr\tsbrdrh\tsbrdrv 
\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fs20\lang1024\langfe1024\cgrid\langnp1024\langfenp1024 \snext11 \ssemihidden Normal Table;}{\s15\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 
\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext15 Dashed List;}{\s16\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext16 Box List;}{\s17\ql \li0\ri0\nowidctlpar
\tx1584\faauto\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon31 \snext0 Section Heading;}{\s18\ql \li0\ri0\nowidctlpar\tx431\faauto\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 
\sbasedon2 \snext0 Numbered Heading 2;}{\s19\ql \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \f2\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext19 Plain Text;}{\s20\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 
\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext20 Implies List;}{\s21\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon29 \snext21 Upper Case List;}{
\s22\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext22 Hand List;}{\s23\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 
\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon29 \snext23 Upper Roman List;}{\s24\ql \li1440\ri1440\sa120\nowidctlpar\faauto\rin1440\lin1440\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext24 
Block Text;}{\s25\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext25 Lower Roman List;}{\s26\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 
\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext26 Heart List;}{\s27\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon29 \snext27 Lower Case List;}{
\s28\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext28 Tick List;}{\s29\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 
\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext29 Numbered List;}{\s30\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext30 Star List;}{\s31\ql \li0\ri0\nowidctlpar
\tx431\faauto\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon1 \snext0 Numbered Heading 1;}{\s32\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 
\snext32 Diamond List;}{\s33\ql \li0\ri0\nowidctlpar\tx431\faauto\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon3 \snext0 Numbered Heading 3;}{\s34\ql \li0\ri0\nowidctlpar\tx1584\faauto\rin0\lin0\itap0 
\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon31 \snext0 Chapter Heading;}{\s35\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext35 Square List;}{
\s36\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext36 Triangle List;}{\s37\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 
\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext37 Bullet List;}{\s38\ql \li0\ri0\nowidctlpar\tqc\tx4320\tqr\tx8640\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext38 \styrsid14225503 
header;}{\s39\ql \li0\ri0\nowidctlpar\tqc\tx4320\tqr\tx8640\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext39 \styrsid14225503 footer;}}{\*\listtable{\list\listtemplateid746733300\listsimple{\listlevel
\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat0\levelspace0\levelindent0{\leveltext\'01\'b7;}{\levelnumbers;}\f3 \fi-431\li720\lin720 }{\listname ;}\listid192734754}{\list\listtemplateid1908756341\listsimple{\listlevel\levelnfc0
\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\fi-431\li720\lin720 }{\listname ;}\listid818376912}{\list\listtemplateid2061311112\listsimple{\listlevel\levelnfc23\levelnfcn23
\leveljc0\leveljcn0\levelfollow0\levelstartat0\levelspace0\levelindent0{\leveltext\'01\'b7;}{\levelnumbers;}\f3 \fi-431\li720\lin720 }{\listname ;}\listid1586128940}{\list\listtemplateid827788416{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0
\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}}{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'04\'00.\'01.;}{\levelnumbers\'01\'03;}}
{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}}{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0
{\leveltext\'02\'00.;}{\levelnumbers\'01;}}{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}}{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0
\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}}{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}}{\listlevel\levelnfc0
\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}}{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext
\'02\'00.;}{\levelnumbers\'01;}}{\listname ;}\listid2107612293}}{\*\listoverridetable{\listoverride\listid2107612293\listoverridecount0\ls1}{\listoverride\listid2107612293\listoverridecount0\ls2}{\listoverride\listid2107612293\listoverridecount0\ls3}
{\listoverride\listid192734754\listoverridecount0\ls4}{\listoverride\listid1586128940\listoverridecount0\ls5}{\listoverride\listid818376912\listoverridecount0\ls6}}{\*\pgptbl {\pgp\ipgp0\itap0\li0\ri0\sb0\sa0}}{\*\rsidtbl \rsid5730313\rsid14225503}
{\*\generator Microsoft Word 10.0.4524;}{\info{\author Ivan R. Judson}{\operator Ivan R. Judson}{\creatim\yr2003\mo5\dy15\hr14\min37}{\revtim\yr2003\mo5\dy15\hr14\min37}{\version2}{\edmins0}{\nofpages9}{\nofwords1985}{\nofchars11321}{\*\company  }
{\nofcharsws13280}{\vern16475}}\margl1440\margr1440 \widowctrl\ftnbj\aenddoc\noxlattoyen\expshrtn\noultrlspc\dntblnsbdb\nospaceforul\hyphcaps0\horzdoc\dghspace120\dgvspace120\dghorigin1701\dgvorigin1984\dghshow0\dgvshow3
\jcompress\viewkind1\viewscale100\nolnhtadjtbl\rsidroot14225503 \fet0\sectd \sbknone\linex0\colsx360\sectdefaultcl\sftnbj {\footer \pard\plain \s39\qc \li0\ri0\nowidctlpar\tqc\tx4320\tqr\tx8640\faauto\rin0\lin0\itap0\pararsid14225503 
\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\f1\fs20\insrsid14225503 Copyright 2003 Argonne National Laboratory/University of Chicago.
\par 
\par }\pard\plain \qc \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0\pararsid14225503 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\f1\fs20\insrsid14225503 For more information email: ag-mcs@mcs.anl.gov.
\par }\pard\plain \s39\ql \li0\ri0\nowidctlpar\tqc\tx4320\tqr\tx8640\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 
\par }}{\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang {\pntxta .}}{\*\pnseclvl2\pnucltr\pnstart1\pnindent720\pnhang {\pntxta .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang {\pntxta .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang {\pntxta )}}
{\*\pnseclvl5\pndec\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl6\pnlcltr\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl7\pnlcrm\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl8
\pnlcltr\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}\pard\plain \s1\qj \li0\ri0\sb440\sa60\nowidctlpar\faauto\outlinelevel0\rin0\lin0\itap0 
\b\f1\fs34\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 Access Grid RPM Package mini-HOWTO}{\b0\fs24\insrsid14225503 
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 Author: Ti Leggett <leggett@mcs.anl.gov>}{\f1\insrsid14225503 
\par }{\insrsid14225503 Date: March 26, 2003}{\f1\insrsid14225503 
\par {\listtext\pard\plain\s31 \b\f1\fs34 \hich\af1\dbch\af0\loch\f1 1.\tab}}\pard\plain \s31\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs34\insrsid14225503 Preface
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 
This document will attempt to describe how to build RPMs of the Access Grid 2.0 software. It will briefly describe how rpm building works and the rpm spec file format and keywords. It will then describe in detail how we use rpm to build our packages.}{
\f1\insrsid14225503 
\par {\listtext\pard\plain\s31 \b\f1\fs34 \hich\af1\dbch\af0\loch\f1 2.\tab}}\pard\plain \s31\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs34\insrsid14225503 Behind RPM

\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 
What an rpm is is basically a tarball with some metadata about that the contents of the tarball. When you install the rpm it basically untars  the contents and add the metadata to a database. Examples of the metadata that are tracked are the file
s in the package, the name of the package, the person and machine who packaged it, what the package provides and what the package depends on to install.}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par To build an rpm you need an rpm spec file. This file lays out the metadata, the packages and sub packages, files that go in those packages, and scripts that can be run at various points of the (un)installation process. }{\f1\insrsid14225503 
\par {\listtext\pard\plain\s18 \b\f1\fs28 \hich\af1\dbch\af0\loch\f1 2.1.\tab}}\pard\plain \s18\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls2\ilvl1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs28\insrsid14225503 
BuildRoot
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 
One of the pieces of metadata is the BuildRoot. Normally when you have a source package, you compile it using make or some
 other method and then install it using make. If you're root, this usually gets installed in /usr or /usr/local. Part of the rpm build process is to compile your software and install it, but you don't want to install the files in /usr or /usr/local while 
y
ou're building it (especially if you're still debugging your rpm build process). This is where BuildRoot comes. It defines a virtual root point where you can install your files temporarily while you're building the rpm. We use /var/tmp/AccessGrid-<version
> (2.0beta as of 03/26/2003). If you were to go into that directory during the build process you'd see what you're install tree looks like. Say your package should have /usr/lib/foo.so, there would be a /var/tmp/AccessGrid-2.0beta/usr/lib/foo.so.}{
\f1\insrsid14225503 
\par }{\insrsid14225503 
\par So if you where you would normally run }{\f5\insrsid14225503 ./configure --prefix=/usr/local}{\insrsid14225503  to set your install prefix, now you would run .}{\f5\insrsid14225503 /configure --prefix=%\{buildroot\}/usr/local}{\insrsid14225503 
 (more on this a bit later). RPM uses the BuildRoot implictly when you define the files that are to go in to the package. So where you see }{\f5\insrsid14225503 /usr/lib/foo.so}{\insrsid14225503  in the }{\f5\insrsid14225503 %files}{\insrsid14225503 
 section, rpm is really looking at }{\f5\insrsid14225503 %\{buildroot\}/usr/lib/foo.so}{\insrsid14225503  to find the file, but it will ultimately put the file in }{\f5\insrsid14225503 /usr/lib/foo.so}{\insrsid14225503  when you install the rpm.}{
\f1\insrsid14225503 
\par {\listtext\pard\plain\s31 \b\f1\fs34 \hich\af1\dbch\af0\loch\f1 3.\tab}}\pard\plain \s31\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs34\insrsid14225503 
The Access Grid 2.0 Spec File
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 
If you haven't already done so, grab the spec file out of CVS. If you really want to follow along grab version 1.8 as that's the version I'm using in this document. I'm going to break the spec file into 6 large sections: Preamble, Package Definitions, B
uilding/Installing Source, File Definitions, Pre/Post Install Scripts, and ChangeLog.}{\f1\insrsid14225503 
\par {\listtext\pard\plain\s18 \b\f1\fs28 \hich\af1\dbch\af0\loch\f1 3.1.\tab}}\pard\plain \s18\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls3\ilvl1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs28\insrsid14225503 
Preamble
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 The Preamble is where we set up some common variables that are used repeatedly throughout the script and it looks like:}
{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par }{\f5\insrsid14225503 %define name\tab \tab AccessGrid}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %define version\tab 2.0beta}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %define release\tab 2}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %define prefix\tab \tab /usr}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %define sysconfdir\tab /etc/%\{name\}}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %define sharedir\tab %\{prefix\}/share}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %define gnomedir\tab %\{sharedir\}/gnome/apps}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %define kdedir\tab \tab %\{sharedir\}/applnk}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %define aghome\tab \tab /var/lib/ag}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %define buildroot\tab /var/tmp/%\{name\}-%\{version\}}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par Each variable starts with }{\f5\insrsid14225503 %define}{\insrsid14225503 , then gives the variable name, then it's value. In order to use the variable, you simply type %\{<variable>\} as is done with }{\f5\insrsid14225503 %\{name\}}{\insrsid14225503 
. The variables that are important here are }{\f5\insrsid14225503 %\{version\}}{\insrsid14225503 , }{\f5\insrsid14225503 %\{release\}}{\insrsid14225503 , and }{\f5\insrsid14225503 %\{buildroot\}}{\insrsid14225503 . The variable }{\f5\insrsid14225503 %\{
buildroot\}}{\insrsid14225503  is what we define our rpm BuildRoot to be.}{\f1\insrsid14225503 
\par {\listtext\pard\plain\s18 \b\f1\fs28 \hich\af1\dbch\af0\loch\f1 3.2.\tab}}\pard\plain \s18\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls3\ilvl1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs28\insrsid14225503 
Package Definitions
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 
The Package Definitions are we define the metadata for a package or sub-package. Here you define the name, versions, URLs, etc. for a package. There are two types of definitions the "top level" package and sub-packages. The "top level" package looks like:
}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par }{\f5\insrsid14225503 Summary:\tab \tab The Access Grid Toolkit}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Name:\tab \tab %\{name\}}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Version:\tab \tab %\{version\}}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Release:\tab \tab %\{release\}}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Copyright:\tab AGTPL}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Group:\tab \tab Utilities/System}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 URL:\tab \tab \tab http://www.accessgrid.org}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Vendor:\tab \tab Argonne National Laboratory}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Source:\tab \tab %\{name\}-%\{version\}.tar.gz}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 BuildRoot:\tab %\{buildroot\}}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Requires:\tab \tab /usr/bin/python2.2}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Requires:\tab \tab pyGlobus}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Requires:\tab \tab logging}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Obsoletes:\tab AccessGrid-2.0alpha}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par %description}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 The Access Grid Tool
kit provides the necessary components for users to participate in Access Grid based collaborations, and also for developers to work on network services, applications services and node services to extend the functionality of the Access Grid.}{
\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par This module provides the core components to start participating in the Access Grid.}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par }{\insrsid14225503 Here you can see the metadata for the "top level" package. Notice that there is a name, version, and release. These are used to make the actual rpm filename and it would look like        }{\f5\insrsid14225503 %\{name\}-%\{version\}-%\{
release\}.i386.rpm}{\insrsid14225503  and with the variable substituted from the Preamble you get }{\f5\insrsid14225503 AccessGrid-2.0beta-2.i386.rpm}{\insrsid14225503 . }{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par A sub-package looks like:}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par }{\f5\insrsid14225503 %package VenueClient}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Summary:\tab \tab The Access Grid Toolkit Venue Client}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Version:\tab \tab %\{version\}}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Release:\tab \tab %\{release\}}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Group:\tab \tab Utilities/System}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Requires:\tab \tab AccessGrid}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Obsoletes:\tab AccessGrid-VenueClient-2.0alpha}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par %description VenueClient}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 The Access Grid Toolkit provides the necessary components for users to participate in Access Grid based collaborations, and also for developers to work on network services, applications services a
nd node services to extend the functionality of the Access Grid.}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par This module provides the components needed to connect to an Access Grid Venue.}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par }{\insrsid14225503 Notice that there is no Name, there is now a line with a }{\f5\insrsid14225503 %package}{\insrsid14225503  directive, and the }{\f5\insrsid14225503 %description}{\insrsid14225503  directive no
w has an "argument." The reason a sub-package has no Name is because it derives it from the "top level" package. A sub-package file name has the form }{\f5\insrsid14225503 "top level name"-%\{package\}-%[version\}-%\{release\}.i386.rpm}{\insrsid14225503 
 or in this case }{\f5\insrsid14225503 AccessGrid-VenueClient-2.0beta-2.i386.rpm}{\insrsid14225503 .}{\f1\insrsid14225503 
\par {\listtext\pard\plain\s18 \b\f1\fs28 \hich\af1\dbch\af0\loch\f1 3.3.\tab}}\pard\plain \s18\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls3\ilvl1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs28\insrsid14225503 
Building/Installing Source
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 
The Access Grid 2.0 Toolkit is based by and large on python. It only makes sense to make use of some of the built-in python tools like distutils. We use distutils to build the python source and install it into t
he BuildRoot. There are three rpm directives that are useful here:}{\f1\insrsid14225503 
\par {\pntext\pard\plain\f3 \loch\af3\dbch\af0\hich\f3 \'b7\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlblt\ilvl0\ls4\pnrnot0\pnf3\pnindent360\pnsp120\pnhang {\pntxtb \'b7}}\faauto\ls4\rin0\lin720\itap0 {\insrsid14225503 
%prep - Untar the source tarball and prep the source tree
\par {\pntext\pard\plain\f3 \loch\af3\dbch\af0\hich\f3 \'b7\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlblt\ilvl0\ls4\pnrnot0\pnf3\pnindent360\pnsp120\pnhang {\pntxtb \'b7}}\faauto\ls4\rin0\lin720\itap0 {\insrsid14225503 %build - Build the source

\par {\pntext\pard\plain\f3 \loch\af3\dbch\af0\hich\f3 \'b7\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlblt\ilvl0\ls4\pnrnot0\pnf3\pnindent360\pnsp120\pnhang {\pntxtb \'b7}}\faauto\ls4\rin0\lin720\itap0 {\insrsid14225503 
%install - Install the built files into the BuildRoot
\par }\pard \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 {\insrsid14225503 The Build/Install section looks like:}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par }{\f5\insrsid14225503 %prep}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %setup}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 [ -n "%\{buildroot\}" -a "%\{buildroot\}" != / ] && rm -rf %\{buildroot\}}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par %build}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 python2.2 setup.py build}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par %install}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 python2.2 setup.py install --prefix=%\{buildroot\}%\{prefix\} --no-compile}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 mv %\{buildroot\}%\{prefix\}/etc %\{buildroot\}}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 mv %\{buildroot\}%\{prefix\}/var %\{buildroot\}}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 mkdir -p %\{buildroot\}/tmp/local_services}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par }{\insrsid14225503 Here you can see we untar the source tarball (using the }{\f5\insrsid14225503 %setup}{\insrsid14225503  rpm macro), remove any previous BuildRoot, build the source using python, install using python, and then make some modificatio
ns to the installed tree to better fit our needs. We make these modifications because of some minor limitations in distutils. Namely, in distutils you can either install a file relative to the prefix or to an absolute path. So by default, everything is in
stalled into }{\f5\insrsid14225503 /usr}{\insrsid14225503 . This is fine except we really do want some of these files under }{\f5\insrsid14225503 /}{\insrsid14225503 , like }{\f5\insrsid14225503 etc/}{\insrsid14225503  and }{\f5\insrsid14225503 var/}{
\insrsid14225503  so we just move them down to the BuildRoot level. At this point our BuildRoot looks like:}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par }{\f5\insrsid14225503 usr/}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 etc/}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 var/}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 tmp/local_services}{\f1\insrsid14225503 
\par {\listtext\pard\plain\s18 \b\f1\fs28 \hich\af1\dbch\af0\loch\f1 3.4.\tab}}\pard\plain \s18\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls3\ilvl1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs28\insrsid14225503 
File Definitions
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 The 
File Definitions section is where you define which of those installed files go into which package. In the files list you can specify permissions of the file, ownership of the file, whether the file is a config file, as well as many other things. A File De
finition list looks like:}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par }{\f5\insrsid14225503 %files}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %doc %\{sharedir\}/doc/}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %defattr(-,root,root)}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %\{prefix\}/lib}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %defattr(0755,root,root)}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %\{prefix\}/bin/AGServiceManager.py}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 /etc/init.d/agsm}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %defattr(0755,ag,ag)}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %dir %\{aghome\}/local_services}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %defattr(0777,nobody,nobody)}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %dir /tmp/local_services}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %defattr(0644,root,root)}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 %config %\{sysconfdir\}/AGServiceManager.cfg}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par }{\insrsid14225503 Here we start the definitions list with the }{\f5\insrsid14225503 %files}{\insrsid14225503  directive. This is the Files Definitions list for the "top level" package. For sub-packages it would look like:}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par }{\f5\insrsid14225503 %files VenueClient}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par Each line is either a filename or setting the attributes for files below. I'll explain key points below:}{\f1\insrsid14225503 
\par {\pntext\pard\plain\f3 \loch\af3\dbch\af0\hich\f3 \'b7\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlblt\ilvl0\ls5\pnrnot0\pnf3\pnindent360\pnsp120\pnhang {\pntxtb \'b7}}\faauto\ls5\rin0\lin720\itap0 {\f5\insrsid14225503 %doc}{\insrsid14225503 
 - This specifies to RPM that the file following the directive is a documentation file
\par {\pntext\pard\plain\f3 \loch\af3\dbch\af0\hich\f3 \'b7\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlblt\ilvl0\ls5\pnrnot0\pnf3\pnindent360\pnsp120\pnhang {\pntxtb \'b7}}\faauto\ls5\rin0\lin720\itap0 {\f5\insrsid14225503 %defattr}{
\insrsid14225503  - This specifies attributes for files below it. It's of the form (<perms>,<owner>,<group>). A dash (-) in any of those fields means use value of the installed file.
\par {\pntext\pard\plain\f3 \loch\af3\dbch\af0\hich\f3 \'b7\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlblt\ilvl0\ls5\pnrnot0\pnf3\pnindent360\pnsp120\pnhang {\pntxtb \'b7}}\faauto\ls5\rin0\lin720\itap0 {\f5\insrsid14225503 %dir}{\insrsid14225503 
 - This directive specifies to only package the directory and no files, if any, underneath it
\par {\pntext\pard\plain\f3 \loch\af3\dbch\af0\hich\f3 \'b7\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlblt\ilvl0\ls5\pnrnot0\pnf3\pnindent360\pnsp120\pnhang {\pntxtb \'b7}}\faauto\ls5\rin0\lin720\itap0 {\f5\insrsid14225503 %config}{
\insrsid14225503  - This specifies to RPM that the file following is a configuration file
\par {\listtext\pard\plain\s18 \b\f1\fs28 \hich\af1\dbch\af0\loch\f1 3.5.\tab}}\pard\plain \s18\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls3\ilvl1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs28\insrsid14225503 
Pre/Postinstall Scripts
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 
You can specify that commands be run prior to installing, after installing, prior to uninstalling, and after uninstalling a rpm package using the rpm directives }{\f5\insrsid14225503 %pre}{\insrsid14225503 , }{\f5\insrsid14225503 %post}{\insrsid14225503 
, }{\f5\insrsid14225503 %preun}{\insrsid14225503 , and }{\f5\insrsid14225503 %postun}{\insrsid14225503  respectively. By default these are run from a bash shell and so bash scripting can be used. A simple example of a script is:}{\f1\insrsid14225503 

\par }{\insrsid14225503 
\par }{\f5\insrsid14225503 %post VenueClient}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 /sbin/chkconfig --add agns}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par }{\insrsid14225503 Whereas a more complicated script is:}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par }{\f5\insrsid14225503 %post}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 cat <<EOF > /tmp/AccessGrid-Postinstall.py}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 #!/usr/bin/python2.2}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 import AccessGrid}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 import AccessGrid.hosting}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 import AccessGrid.hosting.pyGlobus}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 import os}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 import os.path}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 import glob}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 import sys}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par def modimport(module):}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503     for module_file in glob.glob(os.path.join(module.__path__[0], "*.py")):}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 \tab try:}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503             __import__(module.__name__ + "." + os.path.basename(module_file[:-3]))}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 \tab except:}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 \tab     pass}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par sys.stdout.write("Compiling Access Grid Python modules.... ")}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 modimport(AccessGrid)}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 modimport(AccessGrid.hosting)}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 modimport(AccessGrid.hosting.pyGlobus)}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 sys.stdout.write("Done\\n")}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 EOF}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 chmod +x /tmp/AccessGrid-Postinstall.py}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 /tmp/AccessGrid-Postinstall.py}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 rm -f /tmp/AccessGrid-Postinstall.py}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 /sbin/chkconfig --add agsm}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par The first script just calls the chkconfig command to remove the agns service prior to uninstalling the AccessGrid-VenueClient rpm. The second script creates a file that is actually a python script that compiles all the modules in the AccessGrid rpm, runs 
it, then deletes it as well as running chkconfig to add the agsm service.}{\f1\insrsid14225503 
\par {\listtext\pard\plain\s18 \b\f1\fs28 \hich\af1\dbch\af0\loch\f1 3.6.\tab}}\pard\plain \s18\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls3\ilvl1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs28\insrsid14225503 
ChangeLog
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 
The ChangeLog is where you keep a history of the changes to the rpm spec file. It must be in chronological order with most recent events at the top. It looks like:}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par }{\f5\insrsid14225503 %changelog}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 * Wed Mar 26 2003 Ti Leggett <leggett@mcs.anl.gov>}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 - Added a plethora of comments}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 - Fixed a few permissions for some install files}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 - Now removes the AccessGrid pre-uninstall script after it's run}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par * Thu Mar 13 2003 Ti Leggett <leggett@mcs.anl.gov>}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 - Added user and group creation in preinstall}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 - Added postinstall to compile python modules}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 - Services are added to chkconfig for starting}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 - Added preuninstall to remove compiled modules}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 - Move etc and var down a dir after python install so they're where they need to be}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par * Fri Feb 21 2003 Ti Leggett <leggett@mcs.anl.gov>}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 - Fixed where docs go}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 - Added default node configuration file}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par * Fri Feb 14 2003 Ti Leggett <leggett@mcs.anl.gov>}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 - Added postinstall for VenueClient to create AGNodeService config file}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par * Thu Feb 13 2003 Ti Leggett <leggett@mcs.anl.gov>}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 - Added SetupVideo.py to VideoProducer}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par * Fri Feb 06 2003 Ti Leggett <leggett@mcs.anl.gov>}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 - Modularized the RPMs}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par * Tue Feb 05 2003 Ti Leggett <leggett@mcs.anl.gov>}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 - This file was created}{\f1\insrsid14225503 
\par {\listtext\pard\plain\s31 \b\f1\fs34 \hich\af1\dbch\af0\loch\f1 4.\tab}}\pard\plain \s31\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs34\insrsid14225503 
Packaging the Access Grid Toolkit
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 Once you have an understanding of the above you need to actually make the rpms. The process of doing this is as follows:
}{\f1\insrsid14225503 
\par {\pntext\pard\plain\hich\af0\dbch\af0\loch\f0 1.\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlbody\ilvl0\ls6\pnrnot0\pndec\pnstart1\pnindent360\pnsp120\pnhang {\pntxta .}}\faauto\ls6\rin0\lin720\itap0 {\insrsid14225503 
Checkout the Access Grid Toolkit from CVS
\par {\pntext\pard\plain\hich\af0\dbch\af0\loch\f0 2.\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlbody\ilvl0\ls6\pnrnot0\pndec\pnstart1\pnindent360\pnsp120\pnhang {\pntxta .}}\faauto\ls6\rin0\lin720\itap0 {\insrsid14225503 Make the source tarball

\par {\pntext\pard\plain\hich\af0\dbch\af0\loch\f0 3.\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlbody\ilvl0\ls6\pnrnot0\pndec\pnstart1\pnindent360\pnsp120\pnhang {\pntxta .}}\faauto\ls6\rin0\lin720\itap0 {\insrsid14225503 Become root
\par {\pntext\pard\plain\hich\af0\dbch\af0\loch\f0 4.\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlbody\ilvl0\ls6\pnrnot0\pndec\pnstart1\pnindent360\pnsp120\pnhang {\pntxta .}}\faauto\ls6\rin0\lin720\itap0 {\insrsid14225503 Copy th
e spec file and source tarball to the RPM build tree
\par {\pntext\pard\plain\hich\af0\dbch\af0\loch\f0 5.\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlbody\ilvl0\ls6\pnrnot0\pndec\pnstart1\pnindent360\pnsp120\pnhang {\pntxta .}}\faauto\ls6\rin0\lin720\itap0 {\insrsid14225503 Build the RPM
\par }\pard \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 {\insrsid14225503 
\par A real world example might look something like this:}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par }{\f5\insrsid14225503 cd /sandbox/AGCVS/HEAD}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 rm -rf AccessGrid}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 cvs co AccessGrid}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 mv AccessGrid AccessGrid-2.0beta}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 tar zxcf AccessGrid-2.0beta.tar.gz AccessGrid}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 su}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 cd /usr/src/redhat}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 cp /sandbox/AGCVS/HEAD/AccessGrid-2.0beta.tar.gz SOURCES/.}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 cp /sandbox/AGCVS/HEAD/AccessGrid/packaging/redhat/AccessGrid.spec SPECS/.}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 cd SPECS}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 rpm -ba AccessGrid.spec}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 
\par }{\insrsid14225503 
Here's what this does. First you need to change to a directory where you will checkout the package and delete any previous cvs module currently there. Then you need to check out the AccessGrid module. Then you make the source tarball. The name of the tarb
all comes from the spec file from the "top level" package description where the line looks like:}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par }{\f5\insrsid14225503 Source:\tab \tab %\{name\}-%\{version\}.tar.gz}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par Then you must become root and change to the RPM build tree which by default is }{\f5\insrsid14225503 /usr/src/redhat}{\insrsid14225503  and copy the source tarball 
and spec file to the proper locations. Then you build the rpm from the spec file. If all goes well you should see lines like:}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par }{\f5\insrsid14225503 Wrote: /usr/src/redhat/SRPMS/AccessGrid-2.0beta-2.src.rpm}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Wrote: /usr/src/redhat/RPMS/i386/AccessGrid-2.0beta-2.i386.rpm}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Wrote: /usr/src/redhat/RPMS/i386/AccessGrid-VenueClient-2.0beta-2.i386.rpm}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Wrote: /usr/src/redhat/RPMS/i386/AccessGrid-VenueServer-2.0beta-2.i386.rpm}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Wrote: /usr/src/redhat/RPMS/i386/AccessGrid-VideoProducer-2.0beta-2.i386.rpm}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Wrote: /usr/src/redhat/RPMS/i386/AccessGrid-VideoConsumer-2.0beta-2.i386.rpm}{\f1\insrsid14225503 
\par }{\f5\insrsid14225503 Wrote: /usr/src/redhat/RPMS/i386/AccessGrid-AudioService-2.0beta-2.i386.rpm}{\f1\insrsid14225503 
\par }{\insrsid14225503 
\par Which tells you where it actually wrote the rpms.}{\f1\insrsid14225503 
\par {\listtext\pard\plain\s31 \b\f1\fs34 \hich\af1\dbch\af0\loch\f1 5.\tab}}\pard\plain \s31\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs34\insrsid14225503 Links
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid14225503 Maximum RPM Documentation :: http://www.rpm.org/max-rpm/}{\f1\insrsid14225503 
\par }{\insrsid14225503 Python Disutils Documentation :: http://www.python.org/dev/doc/devel/dist/dist.html
\par }}