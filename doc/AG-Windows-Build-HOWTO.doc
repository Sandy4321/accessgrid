{\rtf1\ansi\ansicpg1252\uc1\deff0\stshfdbch0\stshfloch0\stshfhich0\stshfbi0\deflang1033\deflangfe1033{\fonttbl{\f0\froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}{\f1\fswiss\fcharset0\fprq2{\*\panose 020b0604020202020204}Arial;}
{\f2\fmodern\fcharset0\fprq1{\*\panose 02070309020205020404}Courier New;}{\f3\froman\fcharset2\fprq2{\*\panose 05050102010706020507}Symbol;}{\f5\fmodern\fcharset0\fprq1{\*\panose 02070409020205020404}Courier{\*\falt Courier New};}
{\f35\fswiss\fcharset0\fprq2{\*\panose 020b0604030504040204}Tahoma;}{\f104\froman\fcharset238\fprq2 Times New Roman CE;}{\f105\froman\fcharset204\fprq2 Times New Roman Cyr;}{\f107\froman\fcharset161\fprq2 Times New Roman Greek;}
{\f108\froman\fcharset162\fprq2 Times New Roman Tur;}{\f109\froman\fcharset177\fprq2 Times New Roman (Hebrew);}{\f110\froman\fcharset178\fprq2 Times New Roman (Arabic);}{\f111\froman\fcharset186\fprq2 Times New Roman Baltic;}
{\f112\froman\fcharset163\fprq2 Times New Roman (Vietnamese);}{\f114\fswiss\fcharset238\fprq2 Arial CE;}{\f115\fswiss\fcharset204\fprq2 Arial Cyr;}{\f117\fswiss\fcharset161\fprq2 Arial Greek;}{\f118\fswiss\fcharset162\fprq2 Arial Tur;}
{\f119\fswiss\fcharset177\fprq2 Arial (Hebrew);}{\f120\fswiss\fcharset178\fprq2 Arial (Arabic);}{\f121\fswiss\fcharset186\fprq2 Arial Baltic;}{\f122\fswiss\fcharset163\fprq2 Arial (Vietnamese);}{\f124\fmodern\fcharset238\fprq1 Courier New CE;}
{\f125\fmodern\fcharset204\fprq1 Courier New Cyr;}{\f127\fmodern\fcharset161\fprq1 Courier New Greek;}{\f128\fmodern\fcharset162\fprq1 Courier New Tur;}{\f129\fmodern\fcharset177\fprq1 Courier New (Hebrew);}
{\f130\fmodern\fcharset178\fprq1 Courier New (Arabic);}{\f131\fmodern\fcharset186\fprq1 Courier New Baltic;}{\f132\fmodern\fcharset163\fprq1 Courier New (Vietnamese);}{\f454\fswiss\fcharset238\fprq2 Tahoma CE;}{\f455\fswiss\fcharset204\fprq2 Tahoma Cyr;}
{\f457\fswiss\fcharset161\fprq2 Tahoma Greek;}{\f458\fswiss\fcharset162\fprq2 Tahoma Tur;}{\f459\fswiss\fcharset177\fprq2 Tahoma (Hebrew);}{\f460\fswiss\fcharset178\fprq2 Tahoma (Arabic);}{\f461\fswiss\fcharset186\fprq2 Tahoma Baltic;}
{\f462\fswiss\fcharset163\fprq2 Tahoma (Vietnamese);}{\f463\fswiss\fcharset222\fprq2 Tahoma (Thai);}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;
\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}{\stylesheet{
\ql \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext0 Normal;}{\s1\ql \li0\ri0\sb440\sa60\nowidctlpar\faauto\outlinelevel0\rin0\lin0\itap0 
\b\f1\fs34\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext0 heading 1;}{\s2\ql \li0\ri0\sb440\sa60\nowidctlpar\faauto\outlinelevel1\rin0\lin0\itap0 \b\f1\fs28\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext0 
heading 2;}{\s3\ql \li0\ri0\sb440\sa60\nowidctlpar\faauto\outlinelevel2\rin0\lin0\itap0 \b\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext0 heading 3;}{\*\cs10 \additive \ssemihidden Default Paragraph Font;}{\*
\ts11\tsrowd\trftsWidthB3\trpaddl108\trpaddr108\trpaddfl3\trpaddft3\trpaddfb3\trpaddfr3\trcbpat1\trcfpat1\tscellwidthfts0\tsvertalt\tsbrdrt\tsbrdrl\tsbrdrb\tsbrdrr\tsbrdrdgl\tsbrdrdgr\tsbrdrh\tsbrdrv 
\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fs20\lang1024\langfe1024\cgrid\langnp1024\langfenp1024 \snext11 \ssemihidden Normal Table;}{\s15\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 
\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext15 Dashed List;}{\s16\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext16 Box List;}{\s17\ql \li0\ri0\nowidctlpar
\tx1584\faauto\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon31 \snext0 Section Heading;}{\s18\ql \li0\ri0\nowidctlpar\tx431\faauto\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 
\sbasedon2 \snext0 Numbered Heading 2;}{\s19\ql \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \f2\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext19 Plain Text;}{\s20\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 
\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext20 Implies List;}{\s21\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon29 \snext21 Upper Case List;}{
\s22\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext22 Hand List;}{\s23\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 
\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon29 \snext23 Upper Roman List;}{\s24\ql \li1440\ri1440\sa120\nowidctlpar\faauto\rin1440\lin1440\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext24 
Block Text;}{\s25\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext25 Lower Roman List;}{\s26\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 
\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext26 Heart List;}{\s27\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon29 \snext27 Lower Case List;}{
\s28\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext28 Tick List;}{\s29\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 
\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext29 Numbered List;}{\s30\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext30 Star List;}{\s31\ql \li0\ri0\nowidctlpar
\tx431\faauto\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon1 \snext0 Numbered Heading 1;}{\s32\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 
\snext32 Diamond List;}{\s33\ql \li0\ri0\nowidctlpar\tx431\faauto\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon3 \snext0 Numbered Heading 3;}{\s34\ql \li0\ri0\nowidctlpar\tx1584\faauto\rin0\lin0\itap0 
\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon31 \snext0 Chapter Heading;}{\s35\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext35 Square List;}{
\s36\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext36 Triangle List;}{\s37\ql \fi-431\li720\ri0\nowidctlpar\faauto\rin0\lin720\itap0 
\f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext37 Bullet List;}{\s38\ql \li0\ri0\nowidctlpar\tqc\tx4320\tqr\tx8640\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext38 \styrsid7481329 
header;}{\s39\ql \li0\ri0\nowidctlpar\tqc\tx4320\tqr\tx8640\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext39 \styrsid7481329 footer;}{\s40\ql \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \cbpat9 
\f35\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \sbasedon0 \snext40 \ssemihidden \styrsid5786873 Document Map;}}{\*\listtable{\list\listtemplateid2019197158\listsimple{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0
\levelstartat0\levelspace0\levelindent0{\leveltext\'01\'b7;}{\levelnumbers;}\f3 \fi-431\li720\lin720 }{\listname ;}\listid63668384}{\list\listtemplateid389715648\listsimple{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1
\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\fi-431\li720\lin720 }{\listname ;}\listid897059950}{\list\listtemplateid662081189{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0
{\leveltext\'02\'00.;}{\levelnumbers\'01;}}{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'04\'00.\'01.;}{\levelnumbers\'01\'03;}}{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0
\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}}{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}}{\listlevel
\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}}{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext
\'02\'00.;}{\levelnumbers\'01;}}{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}}{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0
\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}}{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}}{\listname 
;}\listid1314830010}}{\*\listoverridetable{\listoverride\listid1314830010\listoverridecount0\ls1}{\listoverride\listid1314830010\listoverridecount0\ls2}{\listoverride\listid897059950\listoverridecount0\ls3}{\listoverride\listid1314830010
\listoverridecount0\ls4}{\listoverride\listid63668384\listoverridecount0\ls5}}{\*\rsidtbl \rsid940529\rsid2782713\rsid5786873\rsid7481329}{\*\generator Microsoft Word 10.0.4524;}{\info{\author Ivan R. Judson}{\operator Ivan R. Judson}
{\creatim\yr2003\mo5\dy16\hr13\min6}{\revtim\yr2003\mo6\dy4\hr23\min15}{\version3}{\edmins0}{\nofpages6}{\nofwords1326}{\nofchars7563}{\*\company  }{\nofcharsws8872}{\vern16475}}\margl1440\margr1440 
\widowctrl\ftnbj\aenddoc\noxlattoyen\expshrtn\noultrlspc\dntblnsbdb\nospaceforul\hyphcaps0\horzdoc\dghspace120\dgvspace120\dghorigin1701\dgvorigin1984\dghshow0\dgvshow3\jcompress\viewkind1\viewscale100\nolnhtadjtbl\rsidroot7481329 \fet0{\*\template 
C:\\software\\AccessGrid\\AccessGrid\\doc\\AG.dot}\sectd \sbknone\linex0\colsx360\sectdefaultcl\sftnbj {\footer \pard\plain \s39\qc \li0\ri0\nowidctlpar\tqc\tx4320\tqr\tx8640\faauto\rin0\lin0\itap0\pararsid7481329 
\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\f1\fs20\insrsid7481329\charrsid2782713 Copyright 2003 Argonne National Laboratory/University of Chicago.
\par 
\par }\pard\plain \qc \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0\pararsid7481329 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\f1\fs20\insrsid7481329\charrsid2782713 For}{\f1\fs20\insrsid7481329  more information email: ag-mcs}{
\f1\fs20\insrsid7481329\charrsid2782713 @mcs.anl.gov.
\par }\pard\plain \s39\ql \li0\ri0\nowidctlpar\tqc\tx4320\tqr\tx8640\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid7481329 
\par }}{\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang {\pntxta .}}{\*\pnseclvl2\pnucltr\pnstart1\pnindent720\pnhang {\pntxta .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang {\pntxta .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang {\pntxta )}}
{\*\pnseclvl5\pndec\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl6\pnlcltr\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl7\pnlcrm\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl8
\pnlcltr\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}\pard\plain \s1\qj \li0\ri0\sb440\sa60\nowidctlpar\faauto\outlinelevel0\rin0\lin0\itap0 
\b\f1\fs34\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid7481329 Access Grid Windows Package mini-HOWTO}{\b0\fs24\insrsid7481329 
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid7481329 Author: Ti Leggett <leggett@mcs.anl.gov>}{\f1\insrsid7481329 
\par }{\insrsid7481329 Date: March 28, 2003}{\f1\insrsid7481329 
\par {\listtext\pard\plain\s31 \b\f1\fs34\insrsid7481329 \hich\af1\dbch\af0\loch\f1 1.\tab}}\pard\plain \s31\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs34\insrsid7481329 
Preface
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid7481329 
This document will attempt to describe how to build a Windows installer of the Access Grid 2.0 software. It will briefly describe the tools we use to generate the installer and then describe in detail how we use the tools to build our Windows installer.}{
\f1\insrsid7481329 
\par {\listtext\pard\plain\s31 \b\f1\fs34\insrsid7481329 \hich\af1\dbch\af0\loch\f1 2.\tab}}\pard\plain \s31\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs34\insrsid7481329 
Inno Setup
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid7481329 
Inno Setup is a free, open source windows package that allows anyone to make a coherent and rather attractive and modern windows installer. It's quite flexible on what it 
can handle and report, and there is also a scripting language for doing more complex tasks. Inno Setup uses a plain text file with keywords and predefined constants to layout how the installer will look and function as well as what exactly goes into the i
nstaller.}{\f1\insrsid7481329 
\par }{\insrsid7481329 
\par There is also a third party tool called ISTool which is a GUI front end for Inno Setup that helps hide the underlying source file to make the installer build process a bit easier}{\f1\insrsid7481329 
\par {\listtext\pard\plain\s31 \b\f1\fs34\insrsid7481329 \hich\af1\dbch\af0\loch\f1 3.\tab}}\pard\plain \s31\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs34\insrsid7481329 
The Access Grid 2.0 Inno Setup File
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid7481329 Inno Setup has several secti
ons that distinctly define sets of things to do. With the Access Grid installer we make use of only some of those. I'm not going to describe each section and what it does, but instead will only highlight special cases or "interesting" things that we do to
 make the process easier.}{\f1\insrsid7481329 
\par {\listtext\pard\plain\s18 \b\f1\fs28\insrsid7481329 \hich\af1\dbch\af0\loch\f1 3.1.\tab}}\pard\plain \s18\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls2\ilvl1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {
\b\fs28\insrsid7481329 [Setup] Section
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid7481329 The }{\f5\insrsid7481329 [Setup]}{\insrsid7481329 
 section is where we define that metadata that defines the installer, the look of it, where the top level directory is, what the output filename is, etc. For any given build of the installer there sh
ould need to be modifications of only a few of the fields. These fields are handled by preprocessing directives that are at the top of the file and are easily identifiable by starting with }{\f5\insrsid7481329 #define}{\insrsid7481329 
. All the other fields can generally be left alone.}{\f1\insrsid7481329 
\par {\listtext\pard\plain\s18 \b\f1\fs28\insrsid7481329 \hich\af1\dbch\af0\loch\f1 3.2.\tab}}\pard\plain \s18\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls2\ilvl1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {
\b\fs28\insrsid7481329 [Run] Section
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid7481329 The }{\f5\insrsid7481329 [Run]}{\insrsid7481329 
 section lists those commands that can or will be run after the user has installed the package. Commands can be run all the time or can be optionally run. If the command has the latter option, the user will be presented with a list of c
heck boxes to choose what they would like to run after the install. Something of note, if you would like to run a command that isn't a true windows executable (read .exe or .com) it must be executed from a shell as in:}{\f1\insrsid7481329 
\par }{\insrsid7481329 
\par }{\f5\insrsid7481329 Filename: \{app\}\\config\\Postinstall.py; Flags: shellexec}{\f1\insrsid7481329 
\par {\listtext\pard\plain\s18 \b\f1\fs28\insrsid7481329 \hich\af1\dbch\af0\loch\f1 3.3.\tab}}\pard\plain \s18\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls2\ilvl1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {
\b\fs28\insrsid7481329 [_ISToolPreCompile] Section
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid7481329 The }{\f5\insrsid7481329 [_ISToolPreCompile]}{\insrsid7481329  is where we define commands that we want }{
\i\insrsid7481329 prior}{\insrsid7481329  to building the installer. We use this as a way to setup our build tree so it is sane and in a way the Inno Setup installer file thinks it should be. I explain below how we use this for our install process.}{
\f1\insrsid7481329 
\par {\listtext\pard\plain\s31 \b\f1\fs34\insrsid7481329 \hich\af1\dbch\af0\loch\f1 4.\tab}}\pard\plain \s31\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs34\insrsid7481329 
Packaging the Access Grid Toolkit
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid7481329 
Once you have an understanding of the above you need to actually make the installer. The process of doing this is as follows:}{\f1\insrsid7481329 
\par {\pntext\pard\plain\insrsid7481329 \hich\af0\dbch\af0\loch\f0 1.\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlbody\ilvl0\ls3\pnrnot0\pndec\pnstart1\pnindent360\pnsp120\pnhang {\pntxta .}}\faauto\ls3\rin0\lin720\itap0 {\insrsid7481329 
Remove any previous CVS checkout
\par {\pntext\pard\plain\insrsid7481329 \hich\af0\dbch\af0\loch\f0 2.\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlbody\ilvl0\ls3\pnrnot0\pndec\pnstart1\pnindent360\pnsp120\pnhang {\pntxta .}}\faauto\ls3\rin0\lin720\itap0 {\insrsid7481329 
Checkout the Access Grid Toolkit from CVS
\par {\pntext\pard\plain\insrsid7481329 \hich\af0\dbch\af0\loch\f0 3.\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlbody\ilvl0\ls3\pnrnot0\pndec\pnstart1\pnindent360\pnsp120\pnhang {\pntxta .}}\faauto\ls3\rin0\lin720\itap0 {\insrsid7481329 
Checkout ag-vic and ag-rat from CVS
\par {\pntext\pard\plain\insrsid7481329 \hich\af0\dbch\af0\loch\f0 4.\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlbody\ilvl0\ls3\pnrnot0\pndec\pnstart1\pnindent360\pnsp120\pnhang {\pntxta .}}\faauto\ls3\rin0\lin720\itap0 {\insrsid7481329 
Build the ag-rat solution
\par {\pntext\pard\plain\insrsid7481329 \hich\af0\dbch\af0\loch\f0 5.\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlbody\ilvl0\ls3\pnrnot0\pndec\pnstart1\pnindent360\pnsp120\pnhang {\pntxta .}}\faauto\ls3\rin0\lin720\itap0 {\insrsid7481329 
Build the ag-vic solution
\par {\pntext\pard\plain\insrsid7481329 \hich\af0\dbch\af0\loch\f0 6.\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlbody\ilvl0\ls3\pnrnot0\pndec\pnstart1\pnindent360\pnsp120\pnhang {\pntxta .}}\faauto\ls3\rin0\lin720\itap0 {\insrsid7481329 
Open the Access Grid .iss file and edit to reflect your source and output paths, and change any versions that might need updating
\par {\pntext\pard\plain\insrsid7481329 \hich\af0\dbch\af0\loch\f0 7.\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlbody\ilvl0\ls3\pnrnot0\pndec\pnstart1\pnindent360\pnsp120\pnhang {\pntxta .}}\faauto\ls3\rin0\lin720\itap0 {\insrsid7481329 
Build the installer
\par }\pard \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 {\insrsid7481329 That's pretty straight forward. However step 4 actually does some things internally to note.}{\f1\insrsid7481329 
\par }{\insrsid7481329 
\par In order
 to make things clean and to avoid as much the ramifications of things being removed from, disappearing from, or being added to CVS, we use python's distutils module to make a sane tree from which to grab our files. The installer really shouldn't be grabb
ing anything out of the CVS tree. In our case we run two scripts that sanitize the build tree: }{\f5\insrsid7481329 makeServicePackages.py}{\insrsid7481329  and }{\f5\insrsid7481329 Prebuild.cmd}{\insrsid7481329 
. I'll explain what both of these scripts do in detail.}{\f1\insrsid7481329 
\par {\listtext\pard\plain\s18 \b\f1\fs28\insrsid7481329 \hich\af1\dbch\af0\loch\f1 4.1.\tab}}\pard\plain \s18\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls4\ilvl1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {
\b\fs28\insrsid7481329 Building rat and vic
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid7481329 The windows installer depends on rat and 
vic being there, so before doing anything you should build them in either Visual Studio 6 or Visual Studio .NET.}{\f1\insrsid7481329 
\par {\listtext\pard\plain\s18 \b\f1\fs28\insrsid7481329 \hich\af1\dbch\af0\loch\f1 4.2.\tab}}\pard\plain \s18\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls4\ilvl1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {
\b\fs28\insrsid7481329 makeServicePackages.py
\par }\pard\plain \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid7481329 The purpose of this script is to make the zip file services from the currently checked out service files and descri
ptions. This script takes on argument: the path to where the service files are located. Internally it has a list of which services it is looking for to make service zip files, so if you have a new service that needs to be packaged in, you'll need to add y
our service name to the list. Here's the script:}{\f1\insrsid7481329 
\par }{\insrsid7481329 
\par }{\f5\insrsid7481329 import sys}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 import os}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 import zipfile}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par """}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 Make Access Grid service packages}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 Looks in specified input directory for same-named .svc and}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 implementation files, and zips them into the specified output}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 directory.}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 """}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par if len(sys.argv) < 2:}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329     print "Usage : ", sys.argv[0], " <serviceDir>"}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par inputDir = sys.argv[1]}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 outputDir = sys.argv[1]}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par services = ["AudioService", "VideoConsumerService", "VideoProducerService"]}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 if not os.path.isdir(inputDir):}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329     print "The following directory does not exist: ", inputDir}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par os.chdir(inputDir)}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par for service in services:}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par     servDesc = service + ".svc"}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329     servImplPy = service + ".py"}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329     servImplWin = service + ".exe"}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329     servImplLin = service}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par     if not os.path.isfile(servDesc):}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329         continue}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329     }{\f1\insrsid7481329 
\par }{\f5\insrsid7481329     # if associated file found, zip em up together in the outputDir}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329     serviceZipFile = service + ".zip"}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329     print "Writing Package File:", serviceZipFile}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329     zf = zipfile.ZipFile( serviceZipFile, "w" )}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329     zf.write( servDesc )}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329     # check for various implementations}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329     if os.path.isfile(servImplPy):}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329         zf.write(servImplPy)}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par     if os.path.isfile(servImplWin):}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329         zf.write(servImplWin)}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par     if os.path.isfile(servImplLin):}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329         zf.write(servImplLin)}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par     zf.close()}{\f1\insrsid7481329 
\par }{\insrsid7481329 
\par It's pretty straightforward. The only tricky part is that it must change to the service directory so that the zipped up service files have no paths associated with them. This script should be run before }{\f5\insrsid7481329 Prebuild.cmd}{\insrsid7481329 .
}{\f1\insrsid7481329 
\par {\listtext\pard\plain\s18 \b\f1\fs28\insrsid7481329 \hich\af1\dbch\af0\loch\f1 4.3.\tab}}\pard\plain \s18\qj \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls4\ilvl1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {
\b\fs28\insrsid7481329 Prebuild.cmd
\par }\pard\plain \ql \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\insrsid7481329 NOTE:}{\insrsid7481329  You should never
 have to modify this file or even look at it. Unless you're very curious, I would skip this section.}{\f1\insrsid7481329 
\par }\pard \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 {\insrsid7481329 This is the script that will clean up any previous build attempt and use python's distuils to build and install the Access Grid package into a temporary bu
ild root. This build root should contain }{\i\insrsid7481329 all}{\insrsid7481329  the files that will be needed by installer. As of today, here is what the }{\f5\insrsid7481329 Prebuild.cmd}{\insrsid7481329 
 script looks like (I've removed comments and '@' signs for clarity):}{\f1\insrsid7481329 
\par }\pard \qj \li0\ri0\keep\keepn\nowidctlpar\faauto\rin0\lin0\itap0 {\insrsid7481329 
\par }{\f5\insrsid7481329 set VSINSTALLDIR=}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 reg.exe query HKLM\\SOFTWARE\\Microsoft\\VisualStudio\\7.0\\Setup\\VS /v EnvironmentDirectory > msid.txt}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 for /F "skip=1 tokens=3*" %%i IN (msid.txt) DO set VSINSTALLDIR=%%i %%j}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 if exist msid.txt del msid.txt}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 set VCINSTALLDIR=}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 reg.exe query HKLM\\SOFTWARE\\Microsoft\\VisualStudio\\7.0\\Setup\\VS /v ProductDir > msid.txt}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 for /F "skip=1 tokens=3*" %%i IN (msid.txt) DO set VCINSTALLDIR=%%i %%j}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 if exist msid.txt del msid.txt}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par set DevEnvDir=%VSINSTALLDIR%}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par set MSVCDir=%VCINSTALLDIR%\\VC7}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par set PATH=%DevEnvDir%;%MSVCDir%\\BIN;%VCINSTALLDIR%\\Common7\\Tools;%VCINSTALLDIR%\\Common7\\Tools\\bin\\prerelease;%VCINSTALLDIR%\\Common7\\Tools\\bin;%FrameworkSDKDir%\\bin;%FrameworkDir%\\%FrameworkVersion%;%PATH%;}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 set INCLUDE=%MSVCDir%\\ATLMFC\\INCLUDE;%MSVCDir%\\INCLUDE;%MSVCDir%\\PlatformSDK\\include\\prerelease;%MSVCDir%\\PlatformSDK\\include;%FrameworkSDKDir%\\include;%INCLUDE%}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 set LIB=%MSVCDir%\\ATLMFC\\LIB;%MSVCDir%\\LIB;%MSVCDir%\\PlatformSDK\\lib\\prerelease;%MSVCDir%\\PlatformSDK\\lib;%FrameworkSDKDir%\\lib;%LIB%}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par set AGDIR=%1}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 set RATDIR=%AGDIR%\\..\\ag-rat}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 set VICDIR=%AGDIR%\\..\\ag-vic}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par devenv %RATDIR%\\rat\\rat.sln /rebuild Release}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 devenv %VICDIR%\\vic\\vic.sln /rebuild Release}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 
\par rmdir /s /q %AGDIR%\\Release}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 rmdir /s /q %AGDIR%\\build}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 cd %AGDIR%}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 echo Building AG}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 python setup.py build}{\f1\insrsid7481329 
\par }{\f5\insrsid7481329 python setup.py install --prefix=%AGDIR%\\Release --no-compile}{\f1\insrsid7481329 
\par }{\strike\insrsid7481329 
\par }\pard \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 {\insrsid7481329 This script does a few things:}{\f1\insrsid7481329 
\par {\pntext\pard\plain\f3\insrsid7481329 \loch\af3\dbch\af0\hich\f3 \'b7\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlblt\ilvl0\ls5\pnrnot0\pnf3\pnindent360\pnsp120\pnhang {\pntxtb \'b7}}\faauto\ls5\rin0\lin720\itap0 {\insrsid7481329 
Finds out where VisualStudio .NET is installed and sets up the evironment to do command line builds
\par {\pntext\pard\plain\f3\insrsid7481329 \loch\af3\dbch\af0\hich\f3 \'b7\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlblt\ilvl0\ls5\pnrnot0\pnf3\pnindent360\pnsp120\pnhang {\pntxtb \'b7}}\faauto\ls5\rin0\lin720\itap0 {\insrsid7481329 
Builds the rat and vic solutions
\par {\pntext\pard\plain\f3\insrsid7481329 \loch\af3\dbch\af0\hich\f3 \'b7\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlblt\ilvl0\ls5\pnrnot0\pnf3\pnindent360\pnsp120\pnhang {\pntxtb \'b7}}\faauto\ls5\rin0\lin720\itap0 {\insrsid7481329 
Cleans up any previous Access Grid build attempt
\par {\pntext\pard\plain\f3\insrsid7481329 \loch\af3\dbch\af0\hich\f3 \'b7\tab}}\pard \qj \fi-431\li720\ri0\nowidctlpar{\*\pn \pnlvlblt\ilvl0\ls5\pnrnot0\pnf3\pnindent360\pnsp120\pnhang {\pntxtb \'b7}}\faauto\ls5\rin0\lin720\itap0 {\insrsid7481329 Rebuilds 
the Access Grid package and installs it into our temporary build root (which, you should recall, is the }{\f5\insrsid7481329 SourceDir}{\insrsid7481329  list in the }{\f5\insrsid7481329 [Setup]}{\insrsid7481329  section of the .iss file)
\par }\pard \qj \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 {\insrsid7481329 The script takes exactly one argument and that's the top level directory of the Access Grid module.}{\f1\insrsid7481329 
\par }{\insrsid7481329 
\par The first action this script does is to get the location of VisualStudio .NET from the registry and set up the environment. Next, it calls the VS.NET command line compiler to build a
g-rat and ag-vic. It then removes any previous build attempts, changes to the CVS module, and then uses python's distutils to build and install the package into our temporary build root. If there are any files that are not in your temporary build root tha
t you would like to add or if paths have changed in CVS where files are, you need to edit }{\f5\insrsid7481329 setup.py}{\insrsid7481329  to add your files. After }{\f5\insrsid7481329 Prebuild.cmd}{\insrsid7481329 
 has run successfully, the installer should continue into its packaging stage, compressing the files and making the installer.}{\f1\insrsid7481329 
\par {\listtext\pard\plain\s31 \b\f1\fs34\insrsid7481329 \hich\af1\dbch\af0\loch\f1 5.\tab}}\pard\plain \s31\ql \li0\ri0\sb440\sa60\nowidctlpar\tx431\faauto\ls1\rin0\lin0\itap0 \f1\fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\fs34\insrsid7481329 
Links
\par }\pard\plain \ql \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\insrsid7481329 Inno Setup :: http://www.jrsoftware.org/isinfo.php}{\f1\insrsid7481329 
\par }{\insrsid7481329 ISTool :: http://www.istool.org/}{\f1\insrsid7481329 
\par }{\insrsid7481329 Python distutils :: http://www.python.org/dev/doc/devel/dist/dist.html
\par }}